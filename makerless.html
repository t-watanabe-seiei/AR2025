<!-- ãƒãƒ¼ã‚«ãƒ¼ãƒ¬ã‚¹ARå®Ÿè£… -->

<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- A-Frame ã‚’èª­ã¿è¾¼ã‚€ -->
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <!-- AR.js NFTç‰ˆã‚’èª­ã¿è¾¼ã‚€ -->
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
    <!-- Animation Mixer ã‚’èª­ã¿è¾¼ã‚€ -->
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
    <script>
      // ãƒãƒ¼ã‚«ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ç”¨ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å®šç¾©
      AFRAME.registerComponent('markerhandler', {
        init: function () {
          console.log('Marker handler component initialized for:', this.el);
          
          // NFTé–¢é€£ã‚¤ãƒ™ãƒ³ãƒˆ
          this.el.addEventListener('markerFound', () => {
            console.log('â­ Marker found via markerFound event');
            
            // å…¨ã¦ã®ãƒœãƒƒã‚¯ã‚¹ã®çŠ¶æ…‹ã‚’ç¢ºèª
            const boxes = this.el.querySelectorAll('a-box');
            console.log(`ğŸ“¦ Found ${boxes.length} boxes in NFT element`);
            
            boxes.forEach((box, index) => {
              const color = box.getAttribute('color');
              const position = box.getAttribute('position');
              const scale = box.getAttribute('scale');
              const visible = box.object3D ? box.object3D.visible : 'no object3D';
              console.log(`ğŸ“¦ Box ${index} - Color: ${color}, Position: ${position}, Scale: ${scale}, Visible: ${visible}`);
              
              if (box.object3D) {
                console.log(`ğŸ“¦ Box ${index} world position:`, box.object3D.getWorldPosition(new THREE.Vector3()));
                console.log(`ğŸ“¦ Box ${index} world scale:`, box.object3D.getWorldScale(new THREE.Vector3()));
              }
            });
            
            // NFTè¦ç´ è‡ªä½“ã®çŠ¶æ…‹ã‚‚ç¢ºèª
            console.log('ğŸ“ NFT element world position:', this.el.object3D.getWorldPosition(new THREE.Vector3()));
            console.log('ğŸ“ NFT element world rotation:', this.el.object3D.getWorldQuaternion(new THREE.Quaternion()));
          });
          
          this.el.addEventListener('markerLost', () => {
            console.log('âŒ Marker lost via markerLost event');
          });
          
          // trackingFound/trackingLostã‚¤ãƒ™ãƒ³ãƒˆã‚‚ç›£è¦–
          this.el.addEventListener('trackingFound', () => {
            console.log('ğŸ¯ NFT tracking found');
          });
          
          this.el.addEventListener('trackingLost', () => {
            console.log('ğŸ” NFT tracking lost');
          });
        },
        
        tick: function() {
          // æ¯ãƒ•ãƒ¬ãƒ¼ãƒ ã€NFTã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®å¯è¦–æ€§ã‚’ãƒã‚§ãƒƒã‚¯
          if (this.el && this.el.object3D) {
            const isVisible = this.el.object3D.visible;
            const currentTime = Date.now();
            
            // 10ç§’ã”ã¨ã«çŠ¶æ…‹ã‚’ãƒ¬ãƒãƒ¼ãƒˆ
            if (!this.lastReport || currentTime - this.lastReport > 10000) {
              console.log(`ğŸ“Š NFT Status - Visible: ${isVisible}, Matrix:`, this.el.object3D.matrixWorld.elements.slice(0,4));
              this.lastReport = currentTime;
            }
          }
        }
      });

      // ãƒ¢ãƒ‡ãƒ«ã®çŠ¶æ…‹ã‚’ç®¡ç†ã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
      AFRAME.registerComponent('model-controller', {
        schema: {
          // åˆæœŸä½ç½®
          initialPosition: { type: 'vec3', default: { x: 0, y: 0, z: 0 } },
          // ç§»å‹•å¾Œã®ä½ç½®
          moveToPosition: { type: 'vec3', default: { x: 5, y: 0, z: 0 } }
        },

        init: function () {
          // ãƒ¢ãƒ‡ãƒ«ã®åˆæœŸçŠ¶æ…‹ã‚’è¨­å®š
          this.el.setAttribute('position', this.data.initialPosition);
          
          // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ…‹ã‚’åˆæœŸåŒ–
          this.isAnimating = false;
          this.currentState = 'initial'; // 'initial' or 'moved'

          // ãƒ¢ãƒ‡ãƒ«ãŒèª­ã¿è¾¼ã¾ã‚ŒãŸæ™‚ã®å‡¦ç†
          this.el.addEventListener('model-loaded', () => {
            // åˆæœŸã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆanime01ã®ãƒ«ãƒ¼ãƒ—ï¼‰ã‚’é–‹å§‹
            this.playAnimation('anime01', true);
          });
        },

        // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å†ç”Ÿé–¢æ•°
        playAnimation: function (clipName, loop = false) {
          if (this.isAnimating) return;
          
          this.el.setAttribute('animation-mixer', {
            clip: clipName,
            loop: loop ? 'repeat' : 'once',
            clampWhenFinished: !loop,
            timeScale: 1
          });

          // ãƒ«ãƒ¼ãƒ—ã—ãªã„ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®å ´åˆã€å®Œäº†ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç›£è¦–
          if (!loop) {
            const mixer = this.el.components['animation-mixer'].mixer;
            if (mixer) {
              this.isAnimating = true;
              const onFinished = () => {
                mixer.removeEventListener('finished', onFinished);
                this.isAnimating = false;
                // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®Œäº†å¾Œã®å‡¦ç†ã‚’ã“ã“ã§è¡Œã†
                this.onAnimationComplete(clipName);
              };
              mixer.addEventListener('finished', onFinished);
            }
          }
        },

        // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®Œäº†æ™‚ã®å‡¦ç†
        onAnimationComplete: function (completedClip) {
          if (completedClip === 'anime02') {
            // anime02å®Œäº†å¾Œã€anime03ã‚’ãƒ«ãƒ¼ãƒ—å†ç”Ÿã—ãªãŒã‚‰ç§»å‹•
            this.playAnimation('anime03', true);
            this.moveModel();
          }
        },

        // ãƒ¢ãƒ‡ãƒ«ã‚’æ–°ã—ã„ä½ç½®ã«ç§»å‹•
        moveModel: function () {
          this.el.setAttribute('animation__position', {
            property: 'position',
            to: this.data.moveToPosition,
            dur: 3000, // 3ç§’ã‹ã‘ã¦ç§»å‹•
            easing: 'easeInOutQuad'
          });

          // ç§»å‹•å®Œäº†å¾Œã®å‡¦ç†
          this.el.addEventListener('animationcomplete__position', () => {
            if (this.currentState === 'initial') {
              this.currentState = 'moved';
              // ç§»å‹•å®Œäº†å¾Œã€anime01ã®ãƒ«ãƒ¼ãƒ—å†ç”Ÿã«æˆ»ã‚‹
              this.playAnimation('anime01', true);
            }
          }, { once: true });
        }
      });

      // ã‚¯ãƒªãƒƒã‚¯æ¤œçŸ¥ç”¨ã®å½“ãŸã‚Šåˆ¤å®šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
      AFRAME.registerComponent('clickable', {
        init: function () {
          console.log('Clickable component initialized');
          
          // çŠ¶æ…‹ç®¡ç†
          this.isIntersected = false;
          this.isHovered = false;
          this.hoverTimeout = null;
          this.isSoundPlaying = false; // ã‚µã‚¦ãƒ³ãƒ‰å†ç”ŸçŠ¶æ…‹ã‚’ç®¡ç†
          this.clickCount = 0; // ã‚¯ãƒªãƒƒã‚¯å›æ•°ã‚’ç®¡ç†
          this.lastClickTime = 0; // ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯æ¤œçŸ¥ç”¨
          
          // ã‚¯ãƒªãƒƒã‚¯å›æ•°è¡¨ç¤ºã‚’åˆæœŸåŒ–
          this.updateClickDisplay();
          
          // ARã§ã®ã‚¯ãƒªãƒƒã‚¯æ¤œçŸ¥ã®ãŸã‚ã€raycasterã¨cursorã‚’ä½¿ç”¨
          this.el.setAttribute('cursor-listener', '');
          
          // è¤‡æ•°ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚¿ã‚¤ãƒ—ã‚’è¨­å®šï¼ˆå„ªå…ˆåº¦é †ï¼‰
          this.el.addEventListener('raycaster-intersected', this.onIntersected.bind(this));
          this.el.addEventListener('raycaster-intersected-cleared', this.onIntersectedCleared.bind(this));
          
          // A-Frame cursor ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆé«˜ç²¾åº¦ï¼‰
          this.el.addEventListener('mouseenter', this.onCursorEnter.bind(this));
          this.el.addEventListener('mouseleave', this.onCursorLeave.bind(this));
          
          // å¾“æ¥ã®ãƒã‚¦ã‚¹ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰
          this.el.addEventListener('mouseover', this.onHover.bind(this));
          this.el.addEventListener('mouseout', this.onHoverEnd.bind(this));
          
          // ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
          this.el.addEventListener('mousedown', this.onClick.bind(this));
          this.el.addEventListener('touchstart', this.onClick.bind(this));
          this.el.addEventListener('click', this.onClick.bind(this));
          
          // é€£ç¶šçš„ãªãƒã‚¦ã‚¹ç§»å‹•ç›£è¦–
          this.setupContinuousMonitoring();
        },

        setupContinuousMonitoring: function () {
          // ãƒã‚¦ã‚¹ä½ç½®ã®é€£ç¶šç›£è¦–
          this.mouseMonitorInterval = setInterval(() => {
            const raycaster = this.el.sceneEl.systems.raycaster;
            if (raycaster && raycaster.raycaster) {
              const intersections = raycaster.raycaster.intersectObject(this.el.object3D, true);
              if (intersections.length > 0 && !this.isIntersected) {
                this.onIntersected();
              } else if (intersections.length === 0 && this.isIntersected) {
                this.onIntersectedCleared();
              }
            }
          }, 100); // 100msã”ã¨ã«ãƒã‚§ãƒƒã‚¯
        },

        onIntersected: function (evt) {
          if (this.isIntersected) return; // é‡è¤‡é˜²æ­¢
          
          console.log('Raycaster intersected - HIGH PRECISION');
          this.isIntersected = true;
          
          // é…å»¶ã‚’ã‚¯ãƒªã‚¢ã—ã¦å³åº§ã«åå¿œ
          if (this.hoverTimeout) {
            clearTimeout(this.hoverTimeout);
            this.hoverTimeout = null;
          }
          
          // è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ï¼ˆé»„è‰²ã§å¼·èª¿ï¼‰
          this.el.setAttribute('material', 'opacity: 0.0; color: #ffff00; emissive: #444400');
        },

        onIntersectedCleared: function (evt) {
          if (!this.isIntersected) return; // é‡è¤‡é˜²æ­¢
          
          console.log('Raycaster intersection cleared');
          
          // å°‘ã—é…å»¶ã•ã›ã¦ã¡ã‚‰ã¤ãã‚’é˜²æ­¢
          this.hoverTimeout = setTimeout(() => {
            this.isIntersected = false;
            this.isHovered = false;
            // å…ƒã®çŠ¶æ…‹ã«æˆ»ã™
            this.el.setAttribute('material', 'opacity: 0.0; color: #ffffff; emissive: #000000');
          }, 50);
        },

        onCursorEnter: function (evt) {
          console.log('Cursor entered - CURSOR EVENT');
          this.isHovered = true;
          
          if (this.hoverTimeout) {
            clearTimeout(this.hoverTimeout);
            this.hoverTimeout = null;
          }
          
          this.el.setAttribute('material', 'opacity: 0.0; color: #00ff00; emissive: #004400');
        },

        onCursorLeave: function (evt) {
          console.log('Cursor left - CURSOR EVENT');
          
          this.hoverTimeout = setTimeout(() => {
            this.isHovered = false;
            if (!this.isIntersected) {
              this.el.setAttribute('material', 'opacity: 0.0; color: #ffffff; emissive: #000000');
            }
          }, 50);
        },

        onHover: function (evt) {
          console.log('Mouse hover detected - MOUSE EVENT');
          this.isHovered = true;
          
          if (this.hoverTimeout) {
            clearTimeout(this.hoverTimeout);
            this.hoverTimeout = null;
          }
          
          this.el.setAttribute('material', 'opacity: 0.0; color: #00ff00; emissive: #002200');
        },

        onHoverEnd: function (evt) {
          console.log('Mouse hover ended - MOUSE EVENT');
          
          this.hoverTimeout = setTimeout(() => {
            this.isHovered = false;
            if (!this.isIntersected) {
              this.el.setAttribute('material', 'opacity: 0.0; color: #ffffff; emissive: #000000');
            }
          }, 50);
        },

        onClick: function (evt) {
          console.log('Click detected on clickable object', evt.type);
          evt.preventDefault();
          evt.stopPropagation();
          
          // NFTæ¤œå‡ºæ™‚ã®ã¿ã‚¯ãƒªãƒƒã‚¯æœ‰åŠ¹
          const nftTarget = document.querySelector('#nft-target');
          if (!nftTarget || !nftTarget.object3D.visible) {
            console.log('NFT target not detected - click ignored');
            return;
          }
          
          // ã‚µã‚¦ãƒ³ãƒ‰å†ç”Ÿä¸­ã¯ã‚¯ãƒªãƒƒã‚¯ã‚’ç„¡åŠ¹ã«ã™ã‚‹
          if (this.isSoundPlaying) {
            console.log('Sound is playing - click ignored');
            return;
          }
          
          // ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯æ¤œçŸ¥ï¼ˆ500msä»¥å†…ã®é€£ç¶šã‚¯ãƒªãƒƒã‚¯ï¼‰
          const currentTime = Date.now();
          if (currentTime - this.lastClickTime < 500) {
            // ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ - ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã‚’ãƒªã‚»ãƒƒãƒˆ
            this.clickCount = 0;
            this.updateClickDisplay();
            console.log('Double click detected - counter reset');
            this.showCelebrationMessage('ğŸ”„ ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ãƒªã‚»ãƒƒãƒˆï¼');
            this.lastClickTime = 0;
            return;
          }
          this.lastClickTime = currentTime;
          
          // ã‚¯ãƒªãƒƒã‚¯å›æ•°ã‚’å¢—åŠ 
          this.clickCount++;
          this.updateClickDisplay();
          console.log('Click count:', this.clickCount);
          
          // ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ãŸã³ã«ã‚µã‚¦ãƒ³ãƒ‰ã‚’å†ç”Ÿ
          this.playClickSound();
          
          // è¦ªè¦ç´ ï¼ˆãƒ¢ãƒ‡ãƒ«æœ¬ä½“ï¼‰ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã‚’å–å¾—
          const modelController = this.el.parentNode.components['model-controller'];
          if (modelController && modelController.currentState === 'initial') {
            console.log('Triggering anime02 animation');
            // anime02ã‚’1å›å†ç”Ÿ
            modelController.playAnimation('anime02', false);
          } else {
            console.log('Model controller not available or not in initial state - but sound still plays');
          }
        },

        // ã‚¯ãƒªãƒƒã‚¯å›æ•°è¡¨ç¤ºã‚’æ›´æ–°ã™ã‚‹é–¢æ•°
        updateClickDisplay: function () {
          const clickCountElement = document.getElementById('click-count');
          if (clickCountElement) {
            clickCountElement.textContent = this.clickCount;
            
            // ã‚¯ãƒªãƒƒã‚¯æ™‚ã«ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœã‚’è¿½åŠ 
            if (this.clickCount > 0) {
              clickCountElement.style.transform = 'scale(1.2)';
              clickCountElement.style.color = '#ffff00';
              setTimeout(() => {
                clickCountElement.style.transform = 'scale(1)';
                clickCountElement.style.color = 'white';
              }, 200);
            }
            
            // ç‰¹å®šã®å›æ•°ã§ãŠç¥ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
            if (this.clickCount === 10) {
              this.showCelebrationMessage('ğŸ‰ 10å›é”æˆï¼');
            } else if (this.clickCount === 50) {
              this.showCelebrationMessage('ğŸŒŸ 50å›é”æˆï¼ã™ã”ã„ï¼');
            } else if (this.clickCount === 100) {
              this.showCelebrationMessage('ğŸ† 100å›é”æˆï¼ç´ æ™´ã‚‰ã—ã„ï¼');
            }
          } else {
            console.warn('Click count display element not found');
          }
        },

        // ãŠç¥ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹é–¢æ•°
        showCelebrationMessage: function (message) {
          const counterDiv = document.getElementById('click-counter');
          if (counterDiv) {
            // ä¸€æ™‚çš„ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
            const originalText = counterDiv.innerHTML;
            counterDiv.innerHTML = `<div style="color: #ffff00; font-size: 20px;">${message}</div>`;
            counterDiv.style.background = 'rgba(255,215,0,0.9)';
            counterDiv.style.color = 'black';
            
            setTimeout(() => {
              counterDiv.innerHTML = originalText;
              counterDiv.style.background = 'rgba(0,0,0,0.7)';
              counterDiv.style.color = 'white';
            }, 2000);
          }
        },

        // ã‚¯ãƒªãƒƒã‚¯æ™‚ã®ã‚µã‚¦ãƒ³ãƒ‰å†ç”Ÿé–¢æ•°
        playClickSound: function () {
          try {
            const soundElement = document.getElementById('sound01');
            if (soundElement) {
              // ã‚µã‚¦ãƒ³ãƒ‰å†ç”ŸçŠ¶æ…‹ã‚’trueã«è¨­å®š
              this.isSoundPlaying = true;
              
              // æ—¢ã«å†ç”Ÿä¸­ã®å ´åˆã¯åœæ­¢ã—ã¦ã‹ã‚‰å†ç”Ÿ
              soundElement.currentTime = 0;
              const playPromise = soundElement.play();
              
              // ã‚µã‚¦ãƒ³ãƒ‰çµ‚äº†ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç›£è¦–
              soundElement.addEventListener('ended', () => {
                this.isSoundPlaying = false;
                console.log('Sound playback finished - clicks enabled');
              }, { once: true });
              
              // ã‚¨ãƒ©ãƒ¼æ™‚ã‚‚ã‚µã‚¦ãƒ³ãƒ‰çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
              soundElement.addEventListener('error', () => {
                this.isSoundPlaying = false;
                console.log('Sound playback error - clicks enabled');
              }, { once: true });
              
              if (playPromise !== undefined) {
                playPromise.then(() => {
                  console.log('Click sound started successfully - clicks disabled during playback');
                }).catch(error => {
                  console.warn('Click sound playback failed:', error);
                  this.isSoundPlaying = false; // ã‚¨ãƒ©ãƒ¼æ™‚ã¯çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
                });
              }
            } else {
              console.warn('Sound01 element not found');
              this.isSoundPlaying = false;
            }
          } catch (error) {
            console.error('Error playing click sound:', error);
            this.isSoundPlaying = false; // ã‚¨ãƒ©ãƒ¼æ™‚ã¯çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
          }
        },

        remove: function () {
          // ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
          if (this.mouseMonitorInterval) {
            clearInterval(this.mouseMonitorInterval);
          }
          if (this.hoverTimeout) {
            clearTimeout(this.hoverTimeout);
          }
          
          // ã‚µã‚¦ãƒ³ãƒ‰çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
          this.isSoundPlaying = false;
          
          // ã‚µã‚¦ãƒ³ãƒ‰è¦ç´ ã®åœæ­¢
          const soundElement = document.getElementById('sound01');
          if (soundElement) {
            soundElement.pause();
            soundElement.currentTime = 0;
          }
        }
      });
      
      // ãƒãƒ¼ã‚«ãƒ¼æ¤œå‡ºçŠ¶æ³ã‚’ç›£è¦–
      document.addEventListener('DOMContentLoaded', function() {
        console.log('Setting up marker detection monitoring...');
        
        // A-SceneãŒæº–å‚™å®Œäº†ã—ãŸã‚‰ç›£è¦–é–‹å§‹
        const scene = document.querySelector('a-scene');
        if (scene) {
          scene.addEventListener('loaded', function() {
            console.log('A-Scene loaded, setting up NFT listeners...');
            
            const nftTarget = document.querySelector('#nft-target');
            if (nftTarget) {
              console.log('NFT element found, adding event listeners...');
              
              // ãƒ¢ãƒ‡ãƒ«è¦ç´ ã®ç¢ºèª
              const modelElement = document.querySelector('#main-model');
              if (modelElement) {
                console.log('âœ… Model element found:', modelElement);
                
                // ãƒ¢ãƒ‡ãƒ«èª­ã¿è¾¼ã¿å®Œäº†ãƒã‚§ãƒƒã‚¯
                modelElement.addEventListener('model-loaded', () => {
                  console.log('ğŸ‰ 3D Model loaded successfully!');
                });
                
                // GLTFã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®èª­ã¿è¾¼ã¿çŠ¶æ³ãƒã‚§ãƒƒã‚¯
                setTimeout(() => {
                  const gltfComponent = modelElement.components['gltf-model'];
                  if (gltfComponent) {
                    console.log('ğŸ“¦ GLTF Component status:', gltfComponent.data, gltfComponent.model);
                  } else {
                    console.error('âŒ GLTF component not found on model element');
                  }
                }, 2000);
              } else {
                console.error('âŒ Model element (#main-model) not found!');
              }
              
              // NFTæ¤œå‡ºã‚¤ãƒ™ãƒ³ãƒˆ
              nftTarget.addEventListener('trackingFound', function() {
                console.log('âœ… NFT target found - 3D model should be visible');
                document.getElementById('debug-info').innerHTML = 
                  '<div style="color: #00ff00;">ğŸ“ NFTèªè­˜ä¸­: 3Dãƒ¢ãƒ‡ãƒ«ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™</div>';
              });
              
              // NFTå–ªå¤±ã‚¤ãƒ™ãƒ³ãƒˆ
              nftTarget.addEventListener('trackingLost', function() {
                console.log('âŒ NFT target lost - 3D model should be hidden');
                document.getElementById('debug-info').innerHTML = 
                  '<div style="color: #ff9900;">ğŸ“± NFTæœªæ¤œå‡º: ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ç”»åƒã‚’ã‚«ãƒ¡ãƒ©ã«æ˜ ã—ã¦ãã ã•ã„</div>';
              });
              
              // NFTèª­ã¿è¾¼ã¿çŠ¶æ³ã‚’ç›£è¦–
              setTimeout(() => {
                console.log('Checking NFT loading status...');
                document.getElementById('debug-info').innerHTML = 
                  '<div style="color: #00ffff;">ğŸ¯ NFTãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿å®Œäº† - ç”»åƒèªè­˜ã‚’é–‹å§‹ã—ã¦ãã ã•ã„</div>';
              }, 3000);
              
              console.log('NFT event listeners set up successfully');
            } else {
              console.warn('NFT target element not found');
              document.getElementById('debug-info').innerHTML = 
                '<div style="color: #ff0000;">âŒ ã‚¨ãƒ©ãƒ¼: NFTè¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</div>';
            }
          });
          
          // AR.jsåˆæœŸåŒ–å®Œäº†ã‚’ç›£è¦–
          scene.addEventListener('arjs-video-loaded', function() {
            console.log('ï¿½ AR.js video loaded successfully');
            document.getElementById('debug-info').innerHTML = 
              '<div style="color: #ffff00;">ï¿½ ã‚«ãƒ¡ãƒ©æº–å‚™å®Œäº† - NFTèª­ã¿è¾¼ã¿ä¸­...</div>';
          });
        }
      });
    </script>
    <title>**0919nftï¼‘ï¼”***</title>
  </head>
  <body style="margin: 0; overflow: hidden">
    
    <!-- ã‚¯ãƒªãƒƒã‚¯å›æ•°è¡¨ç¤º -->
    <div id="click-counter" style="position: fixed; top: 20px; left: 20px; background: rgba(0,0,0,0.7); color: white; padding: 10px 15px; border-radius: 10px; font-family: Arial, sans-serif; font-size: 18px; font-weight: bold; z-index: 1000;">
      ã‚¯ãƒªãƒƒã‚¯å›æ•°: <span id="click-count">0</span>
    </div>
    
    <!-- ãƒ‡ãƒãƒƒã‚°æƒ…å ±è¡¨ç¤º -->
    <div id="debug-info" style="position: fixed; bottom: 20px; left: 20px; background: rgba(0,0,0,0.8); color: white; padding: 15px; border-radius: 10px; font-family: Arial, sans-serif; font-size: 16px; max-width: 400px; z-index: 1000;">
      <div style="color: #ffff00;">ğŸ” NFTåˆæœŸåŒ–ä¸­... ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„</div>
    </div>
	  
    <!-- A-Frameã«AR.jsã‚’ç´ã¥ã‘ã€NFTå°‚ç”¨è¨­å®š -->
    <a-scene embedded 
      arjs="sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;"
      vr-mode-ui="enabled: false;"
      renderer="logarithmicDepthBuffer: true; alpha: true; antialias: true; precision: mediump;"
      camera="far: 10000; near: 0.01;"
      loading-screen="enabled: false;"
      inspector="url: https://cdn.jsdelivr.net/gh/aframevr/aframe-inspector@master/dist/aframe-inspector.min.js"
      device-orientation-permission-ui="enabled: false">
  
      <a-assets>
        <a-asset-item id="neko" src="./asset/3Dmodel.glb"></a-asset-item>
        <audio id="sound01" src="./asset/sound01.mp3" preload="auto"></audio>
      </a-assets>

      <!-- ç’°å¢ƒå…‰ã‚’è¿½åŠ  -->
      <a-light type="ambient" color="#ffffff" intensity="0.8"></a-light>
      <a-light type="directional" position="0 10 5" color="#ffffff" intensity="0.5"></a-light>

      <a-nft 
        type="nft" 
        url="./asset/reference-image"
        smooth="true" 
        smoothCount="10" 
        smoothTolerance="0.01" 
        smoothThreshold="5"
        emitevents="true"
        id="nft-target"
        markerhandler>
    
        <!-- å¤§ããªãƒ†ã‚¹ãƒˆç”¨ãƒœãƒƒã‚¯ã‚¹ï¼ˆç¢ºå®Ÿã«è¦‹ãˆã‚‹ã‚ˆã†ã«ï¼‰ -->
        <a-box
          color="orange"
          scale="50 50 50"
          position="0 0 0"
          material="color: orange; emissive: #ff4400; metalness: 0;">
        </a-box>
        
        <!-- ã‚«ãƒ¡ãƒ©ã«è¿‘ã„ä½ç½®ï¼ˆ20cmç¨‹åº¦ï¼‰ã«é…ç½® - NFTåº§æ¨™ç³»ç”¨å°ã‚¹ã‚±ãƒ¼ãƒ« -->
        <!-- ä¸­å¤®ã®èµ¤ã„ãƒœãƒƒã‚¯ã‚¹ -->
        <a-box
          color="red"
          scale="0.05 0.05 0.05"
          position="0 0 0"
          material="color: red; metalness: 0.1; roughness: 0.5;">
        </a-box>
        
        <!-- ç·‘ã®ãƒœãƒƒã‚¯ã‚¹ï¼ˆå³å´ï¼‰ -->
        <a-box
          color="green"
          scale="0.04 0.04 0.04"
          position="0.1 0 0"
          material="color: green;">
        </a-box>
        
        <!-- é’ã®ãƒœãƒƒã‚¯ã‚¹ï¼ˆå·¦å´ï¼‰ -->
        <a-box
          color="blue"
          scale="0.04 0.04 0.04"
          position="-0.1 0 0"
          material="color: blue;">
        </a-box>
        
        <!-- é»„è‰²ã®ãƒœãƒƒã‚¯ã‚¹ï¼ˆä¸Šå´ï¼‰ -->
        <a-box
          color="yellow"
          scale="0.04 0.04 0.04"
          position="0 0.1 0"
          material="color: yellow;">
        </a-box>
        
        <!-- ãƒã‚¼ãƒ³ã‚¿ã®ãƒœãƒƒã‚¯ã‚¹ï¼ˆä¸‹å´ï¼‰ -->
        <a-box
          color="magenta"
          scale="0.04 0.04 0.04"
          position="0 -0.1 0"
          material="color: magenta;">
        </a-box>
        
        <!-- ç™½ã„ãƒœãƒƒã‚¯ã‚¹ï¼ˆæ‰‹å‰ã«å¤§ããï¼‰ -->
        <a-box
          color="white"
          scale="0.06 0.06 0.06"
          position="0 0 0.05"
          material="color: white;">
        </a-box>
        
        <!-- ã‚·ã‚¢ãƒ³ã®ãƒœãƒƒã‚¯ã‚¹ï¼ˆå¥¥å´ï¼‰ -->
        <a-box
          color="cyan"
          scale="0.045 0.045 0.045"
          position="0 0 -0.05"
          material="color: cyan;">
        </a-box>
        
        <!-- 3Dãƒ¢ãƒ‡ãƒ«ï¼ˆä¸­å¤®ã‚„ã‚„ä¸Šï¼‰ - NFTåº§æ¨™ç³»èª¿æ•´ -->
        <a-entity
          id="main-model"
          gltf-model="#neko"
          scale="0.05 0.05 0.05"
          position="0 0.05 0.02"
          rotation="0 0 0"
          model-controller>
        </a-entity>
        
        <!-- ã‚¯ãƒªãƒƒã‚¯åˆ¤å®šç”¨ã®é€æ˜ãªãƒœãƒƒã‚¯ã‚¹ - NFTåº§æ¨™ç³»èª¿æ•´ -->
        <a-box
          clickable
          scale="0.2 0.2 0.2"
          position="0 0 0"
          material="opacity: 0.0; transparent: true; color: #ffffff; side: double"
          geometry="primitive: box"
          class="clickable"
          raycaster-listen>
        </a-box>
      </a-nft>

      <a-entity camera
        look-controls="enabled: false; magicWindowTrackingEnabled: false;"
        cursor="rayOrigin: mouse"
        raycaster="objects: .clickable; far: 10000; near: 0.01;">
      </a-entity>
    </a-scene>
  </body>
</html>